package com.example.jwt.demojwt;

import static org.junit.Assert.assertTrue;

import java.security.NoSuchAlgorithmException;
import java.security.spec.InvalidKeySpecException;

import com.example.jwt.demojwt.utils.ManagerToken;

import org.junit.jupiter.api.Test;

public class DemoApplicationTests {

	@Test()
	public void GenerateTokenTest() throws Exception {
		// Arrange
		// Action
		String token = ManagerToken.GenerateToken();
		// Assert
		assertTrue(token != null);
	}

	@Test()
	public void DecodeTokenMethodOneTest() throws Exception {

		// Arrange
		// String token = ManagerToken.GenerateToken();
		// String token =
		// "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiMTIzNDU2Nzg5IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpc3MiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsInVzdWFyaW8iOiJwaWxvdG8ubGF6byIsImV4cCI6MTU4MDMwNzk1MywiaWF0IjoxNTgwMjIxNTUzLCJlbWFpbCI6InNjLWFwaXNydW1iby1lbmRwb2ludC1kZXZAdGVycGVsLWd0aWMtb3BlbnNoaWZ0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0.AQ44oPZn1HW4EUhZP6sfAvzu96UB7LUn773mAbYhhGPSiD1gSQLPTYZL-5sDLy01xIueuupNqDUD_lKY55Iy_nvzOI-sruGWaTfaAiBCiYScC7oYHxt4W-1dqzJ20KfoibonMEt0GQ4y8XTQRmTZa3S7ZY5tFraUKXJg5TC1HTWrE9kgfWE3iDuYHhtDzkWJz7vhh3to-8PhCvAdbGxxgianoj-oFGK5QpNi1iZcUclLeV1LvA2WNqOrS73p7jHuBBS-qKnW_ZzKXZVhsUzTDa4ZVeRDmpSNNZ2s6e4TCVqJuRtHY134KZcBt1OfEyQ-ZCGaQQD0Tw6DjrwjITUrWQ";
		String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiOTNkNDc2NzYtYzkyNS00N2VhLTg5MjYtNmNlZGNiY2ZmY2I2IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpZENyZWRpdG8iOiI2NDEzMSIsImlzcyI6InNjLWFwaXNydW1iby1lbmRwb2ludC1kZXZAdGVycGVsLWd0aWMtb3BlbnNoaWZ0LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwidXN1YXJpbyI6InBpbG90by5sYXpvIiwiZXhwIjoxNTgxNjIxODE0LCJpYXQiOjE1ODE1MzU0MTQsImVtYWlsIjoic2MtYXBpc3J1bWJvLWVuZHBvaW50LWRldkB0ZXJwZWwtZ3RpYy1vcGVuc2hpZnQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20ifQ.hqdfAteZskOYxdRgMRj3EteG8hmrzT8zaBFgF_X334Y3zspUvc_5vWMz-BAsOu_Q-qP0B6mVEdDBezgjIknf5HZSfci0XCKmkhzziLAHYgF94Byb5af0v5syr6FQU6lssFumKAsKO-o_IR7WT2dPdTcFlEZuurhBosy2loE1-gg_KUJdbM9sZrfwKDouEV3e5YPZMzHL51h0M8M9T9_-yLBWx3c6CCyq4I8bTHAF_jRVxMpF2gIG_6JVpTV265KxMVEq1a6Xzw4iAQy0Ue8Uek5lJgs0-k_4M8uD5dTNE5Ggmru0P6XUKQW6TdMx1Qng8fcvzGhO6ClY7KZfVe6i-Q";
		//String token = "eyAidHlwIjogIkpXVCIsICJraWQiOiAiU3lsTEM2Tmp0MUtHUWt0RDlNdCswemNlUVNVPSIsICJhbGciOiAiUlMyNTYiIH0.eyAic3ViIjogInRlc3R1c2VyMkBleGFtcGxlLmNvbSIsICJpc3MiOiAiaHR0cDovL29wZW5hbS5ob25leXdlbGwuY29tOjYwODAvb3BlbmFtL29hdXRoMiIsICJ0b2tlbk5hbWUiOiAiaWRfdG9rZW4iLCAibm9uY2UiOiAiNjM2MDIyNDM5NzE4NDUyODE2Lk1tTXpOelZrWm1JdFpXVXpZeTAwTkRZd0xXRXdNell0T1RnNU1HVmxZemMyTTJRek1qVmlPVEE0T0dJdFpHSm1ZeTAwWm1JMExXSXdOV010TWpsbFpXUTNNRE16TURabSIsICJhdWQiOiBbICJmcmN1c3RvbWFwcHJlZyIgXSwgImNfaGFzaCI6ICJGMUlKU3UyRV80MTNnU21sRDdBZ3lnIiwgIm9yZy5mb3JnZXJvY2sub3BlbmlkY29ubmVjdC5vcHMiOiAiYTI5ODRkOTMtMjM5Ni00ZTE5LWI4NjEtY2YxMTZlNTIzM2M2IiwgImF6cCI6ICJmcmN1c3RvbWFwcHJlZyIsICJhdXRoX3RpbWUiOiAxNDY2NjQ3MTg2LCAicmVhbG0iOiAiLyIsICJleHAiOiAxNDY2NjUwNzg3LCAidG9rZW5UeXBlIjogIkpXVFRva2VuIiwgImlhdCI6IDE0NjY2NDcxODcgfQ.kCWJsTLVZSlGmfI6kwVW4BxFrk6fX52GDInda8GfnFNWnceGRG7r9uR_xcfHpppIgiq6PNdu_-kGMpnViYGLvWOMFLeqr-S49v4wGI2jJ5sUrM3luDlnQ5DA7IDJ4r_BUYiORqFwqbSnlRZ2pvgLSohmpZDF_ggHz0Q0SJra-lo";
		// Action
		Object resultado = ManagerToken.DecodeTokenMethodOne(token);

		// Assertion
		assertTrue(resultado != null);
	}


	@Test()
	public void DecodeTokenMethodTwoTest() throws Exception {

		// Arrange
		// String token = ManagerToken.GenerateToken();
		// String token =
		// "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiMTIzNDU2Nzg5IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpc3MiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsInVzdWFyaW8iOiJwaWxvdG8ubGF6byIsImV4cCI6MTU4MDMwNzk1MywiaWF0IjoxNTgwMjIxNTUzLCJlbWFpbCI6InNjLWFwaXNydW1iby1lbmRwb2ludC1kZXZAdGVycGVsLWd0aWMtb3BlbnNoaWZ0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0.AQ44oPZn1HW4EUhZP6sfAvzu96UB7LUn773mAbYhhGPSiD1gSQLPTYZL-5sDLy01xIueuupNqDUD_lKY55Iy_nvzOI-sruGWaTfaAiBCiYScC7oYHxt4W-1dqzJ20KfoibonMEt0GQ4y8XTQRmTZa3S7ZY5tFraUKXJg5TC1HTWrE9kgfWE3iDuYHhtDzkWJz7vhh3to-8PhCvAdbGxxgianoj-oFGK5QpNi1iZcUclLeV1LvA2WNqOrS73p7jHuBBS-qKnW_ZzKXZVhsUzTDa4ZVeRDmpSNNZ2s6e4TCVqJuRtHY134KZcBt1OfEyQ-ZCGaQQD0Tw6DjrwjITUrWQ";
		String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiOTNkNDc2NzYtYzkyNS00N2VhLTg5MjYtNmNlZGNiY2ZmY2I2IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpZENyZWRpdG8iOiI2NDEzMSIsImlzcyI6InNjLWFwaXNydW1iby1lbmRwb2ludC1kZXZAdGVycGVsLWd0aWMtb3BlbnNoaWZ0LmlhbS5nc2VydmljZWFjY291bnQuY29tIiwidXN1YXJpbyI6InBpbG90by5sYXpvIiwiZXhwIjoxNTgxNjIxODE0LCJpYXQiOjE1ODE1MzU0MTQsImVtYWlsIjoic2MtYXBpc3J1bWJvLWVuZHBvaW50LWRldkB0ZXJwZWwtZ3RpYy1vcGVuc2hpZnQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20ifQ.hqdfAteZskOYxdRgMRj3EteG8hmrzT8zaBFgF_X334Y3zspUvc_5vWMz-BAsOu_Q-qP0B6mVEdDBezgjIknf5HZSfci0XCKmkhzziLAHYgF94Byb5af0v5syr6FQU6lssFumKAsKO-o_IR7WT2dPdTcFlEZuurhBosy2loE1-gg_KUJdbM9sZrfwKDouEV3e5YPZMzHL51h0M8M9T9_-yLBWx3c6CCyq4I8bTHAF_jRVxMpF2gIG_6JVpTV265KxMVEq1a6Xzw4iAQy0Ue8Uek5lJgs0-k_4M8uD5dTNE5Ggmru0P6XUKQW6TdMx1Qng8fcvzGhO6ClY7KZfVe6i-Q";

		// Action
		Object resultado = ManagerToken.DecodeTokenMethodTwo(token);

		// Assertion
		assertTrue(resultado != null);
	}

	@Test()
	public void GetPublicKeyTest() throws NoSuchAlgorithmException, InvalidKeySpecException, Exception {
		
		// Arrange
		//String token = ManagerToken.GenerateToken();
		//String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiMTIzNDU2Nzg5IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpc3MiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsInVzdWFyaW8iOiJwaWxvdG8ubGF6byIsImV4cCI6MTU4MDMwNzk1MywiaWF0IjoxNTgwMjIxNTUzLCJlbWFpbCI6InNjLWFwaXNydW1iby1lbmRwb2ludC1kZXZAdGVycGVsLWd0aWMtb3BlbnNoaWZ0LmlhbS5nc2VydmljZWFjY291bnQuY29tIn0.AQ44oPZn1HW4EUhZP6sfAvzu96UB7LUn773mAbYhhGPSiD1gSQLPTYZL-5sDLy01xIueuupNqDUD_lKY55Iy_nvzOI-sruGWaTfaAiBCiYScC7oYHxt4W-1dqzJ20KfoibonMEt0GQ4y8XTQRmTZa3S7ZY5tFraUKXJg5TC1HTWrE9kgfWE3iDuYHhtDzkWJz7vhh3to-8PhCvAdbGxxgianoj-oFGK5QpNi1iZcUclLeV1LvA2WNqOrS73p7jHuBBS-qKnW_ZzKXZVhsUzTDa4ZVeRDmpSNNZ2s6e4TCVqJuRtHY134KZcBt1OfEyQ-ZCGaQQD0Tw6DjrwjITUrWQ";
		//String token = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiJjbGllbnRlLWRlLWRlc2Fycm9sbG8iLCJzdWIiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsImlkZW50aWZpY2Fkb3JBcGxpY2FjaW9uIjoiMTIzNDU2Nzg5IiwiaWRDbGllbnRlIjoiNjQxMzEiLCJpc3MiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsInVzdWFyaW8iOiJwaWxvdG8ucGljYWZ1ZWwiLCJleHAiOjE1ODA0ODcwMDIsImlhdCI6MTU4MDQwMDYwMiwiZW1haWwiOiJzYy1hcGlzcnVtYm8tZW5kcG9pbnQtZGV2QHRlcnBlbC1ndGljLW9wZW5zaGlmdC5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSJ9.PxzFKtEWkHkPWkO6k0GaIvCnVn_WD2ISLuAJrY9n3ZPTcomZVxdKsbbHaCsmpV0YLGIThMVuraxSLaQVkMITBljHIWJP2oTc7DA0TF1YewiVgOsCTN188PAf2szvVrhhUG1AlxenRIz5HC-hm9qSkk_GCHaTXGqQfoU9Ien5YJ8rwpf01_iTQmO51DWCYcbfJRTRpky_2Ol0i-TU8tn4fe9CokndZKKEx-yHNLEfEi7xx71aF-WXvhRJb9G3yeQZZaz-b-TWCzzBtg9CKqtV1eXQO0Gjo4z2SEnaObrYvOBpl_pi9sk-pabMQ8bdgpBPuLSBycYt7Nk-9bJyvfH8Aw";

		// Action
		Object resultado = ManagerToken.GetPublicKey();
		
		// Assertion
		assertTrue(resultado!=null);
	}

}
